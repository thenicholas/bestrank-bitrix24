{"version":3,"file":"task_detail_more_menu.bundle.js","sources":["../src/task_detail_more_menu.js"],"sourcesContent":["import {Type} from 'main.core';\n\nexport class TaskDetailMoreMenu\n{\n\tconstructor(options = {name: 'TaskDetailMoreMenu'})\n\t{\n\t\tthis.name = options.name;\n\t}\n\n\tsetName(name)\n\t{\n\t\tif (Type.isString(name))\n\t\t{\n\t\t\tthis.name = name;\n\t\t}\n\t}\n\n\tgetName()\n\t{\n\t\treturn this.name;\n\t}\n}\n\n// Создаем экземпляр при загрузке экстеншена\nconst menu = new TaskDetailMoreMenu();\nconsole.log('Extension loaded, menu created:', menu);\n\nBX.ready(function () {\n\n\tBX.Event.EventEmitter.subscribe('bx.main.popup:onFirstShow', function(event) {\n\t\tlet menuItems = [];\n\n\t\tBX.ajax.runAction('nick:course.TaskDetailMenuItems.get', {\n\t\t\tdata: {}\n\t\t}).then(function (response) {\n\t\t\tif (response.status === 'success' && Array.isArray(response.data)) {\n\t\t\t\tmenuItems = response.data;  // если let\n\t\t\t\tconst popup = event.target;\n\n\t\t\t\tif (popup.uniquePopupId === 'menu-popup-task-view-b') {\n\t\t\t\t\tlet menuContainer = popup.contentContainer.querySelector('.menu-popup-items');\n\n\t\t\t\t\tif (menuItems.length) {\n\t\t\t\t\t\tmenuItems.forEach(menuText => {\n\t\t\t\t\t\t\tlet newItem = BX.create('span', {\n\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\ttitle: menuText,\n\t\t\t\t\t\t\t\t\tclassName: 'menu-popup-item menu-popup-item-create',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\tBX.create('span', {\n\t\t\t\t\t\t\t\t\t\tattrs: {className: 'menu-popup-item-icon'}\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\tBX.create('span', {\n\t\t\t\t\t\t\t\t\t\tattrs: {className: 'menu-popup-item-text'},\n\t\t\t\t\t\t\t\t\t\ttext: menuText,\n\t\t\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\t\t\t\t\t\talert(menuText);\n\t\t\t\t\t\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tBX.append(newItem, menuContainer);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, function (error) {\n\t\t\tconsole.log(error);\n\t\t});\n\n\t});\n});\n\n"],"names":["TaskDetailMoreMenu","options","name","Type","isString","menu","console","log","BX","ready","Event","EventEmitter","subscribe","event","menuItems","ajax","runAction","data","then","response","status","Array","isArray","popup","target","uniquePopupId","menuContainer","contentContainer","querySelector","length","forEach","menuText","newItem","create","attrs","title","className","children","text","events","click","alert","close","append","error"],"mappings":";;;;;;KAEaA,kBAAkB;GAE9B,8BACA;KAAA,IADYC,OAAO,uEAAG;OAACC,IAAI,EAAE;MAAqB;KAAA;KAEjD,IAAI,CAACA,IAAI,GAAGD,OAAO,CAACC,IAAI;;GACxB;KAAA;KAAA,wBAEOA,IAAI,EACZ;OACC,IAAIC,cAAI,CAACC,QAAQ,CAACF,IAAI,CAAC,EACvB;SACC,IAAI,CAACA,IAAI,GAAGA,IAAI;;;;KAEjB;KAAA,0BAGD;OACC,OAAO,IAAI,CAACA,IAAI;;;GAChB;CAAA;;CAGF;CACA,IAAMG,IAAI,GAAG,IAAIL,kBAAkB,EAAE;CACrCM,OAAO,CAACC,GAAG,CAAC,iCAAiC,EAAEF,IAAI,CAAC;CAEpDG,EAAE,CAACC,KAAK,CAAC,YAAY;GAEpBD,EAAE,CAACE,KAAK,CAACC,YAAY,CAACC,SAAS,CAAC,2BAA2B,EAAE,UAASC,KAAK,EAAE;KAC5E,IAAIC,SAAS,GAAG,EAAE;KAElBN,EAAE,CAACO,IAAI,CAACC,SAAS,CAAC,qCAAqC,EAAE;OACxDC,IAAI,EAAE;MACN,CAAC,CAACC,IAAI,CAAC,UAAUC,QAAQ,EAAE;OAC3B,IAAIA,QAAQ,CAACC,MAAM,KAAK,SAAS,IAAIC,KAAK,CAACC,OAAO,CAACH,QAAQ,CAACF,IAAI,CAAC,EAAE;SAClEH,SAAS,GAAGK,QAAQ,CAACF,IAAI,CAAC;SAC1B,IAAMM,KAAK,GAAGV,KAAK,CAACW,MAAM;SAE1B,IAAID,KAAK,CAACE,aAAa,KAAK,wBAAwB,EAAE;WACrD,IAAIC,aAAa,GAAGH,KAAK,CAACI,gBAAgB,CAACC,aAAa,CAAC,mBAAmB,CAAC;WAE7E,IAAId,SAAS,CAACe,MAAM,EAAE;aACrBf,SAAS,CAACgB,OAAO,CAAC,UAAAC,QAAQ,EAAI;eAC7B,IAAIC,OAAO,GAAGxB,EAAE,CAACyB,MAAM,CAAC,MAAM,EAAE;iBAC/BC,KAAK,EAAE;mBACNC,KAAK,EAAEJ,QAAQ;mBACfK,SAAS,EAAE;kBACX;iBACDC,QAAQ,EAAE,CACT7B,EAAE,CAACyB,MAAM,CAAC,MAAM,EAAE;mBACjBC,KAAK,EAAE;qBAACE,SAAS,EAAE;;kBACnB,CAAC,EACF5B,EAAE,CAACyB,MAAM,CAAC,MAAM,EAAE;mBACjBC,KAAK,EAAE;qBAACE,SAAS,EAAE;oBAAuB;mBAC1CE,IAAI,EAAEP,QAAQ;mBACdQ,MAAM,EAAE;qBACPC,KAAK,EAAE,iBAAM;uBACZC,KAAK,CAACV,QAAQ,CAAC;uBACfR,KAAK,CAACmB,KAAK,EAAE;;;kBAGf,CAAC;gBAEH,CAAC;eACFlC,EAAE,CAACmC,MAAM,CAACX,OAAO,EAAEN,aAAa,CAAC;cACjC,CAAC;;;;MAIL,EAAE,UAAUkB,KAAK,EAAE;OACnBtC,OAAO,CAACC,GAAG,CAACqC,KAAK,CAAC;MAClB,CAAC;IAEF,CAAC;CACH,CAAC,CAAC;;;;;;;;"}